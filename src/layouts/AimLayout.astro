---
// src/layouts/AimLayout.astro
import BaseLayout from './BaseLayout.astro';
import AimNavigation from '../components/AimNavigation.astro';

// The aimNumber is passed from the frontmatter of the .md file
const { frontmatter } = Astro.props;
const { aimNumber } = frontmatter;
---
<BaseLayout>
    <div class="aim-header mb-8">
        <a href="/aims" class="text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 transition-colors duration-300">&larr; Back to Aims</a>
        <h1 class="text-4xl font-bold mt-4 text-gray-900 dark:text-gray-100">{frontmatter.title}</h1>
    </div>
    <div class="prose dark:prose-invert max-w-none">
        <slot />
    </div>
    <AimNavigation aimNumber={aimNumber} />

    <script is:inline>
        document.addEventListener('DOMContentLoaded', () => {
            const codeBlocks = document.querySelectorAll('pre code');

            codeBlocks.forEach(codeBlock => {
                const pre = codeBlock.parentNode;
     
                           if (pre.tagName === 'PRE') {
                    const container = document.createElement('div');
                    container.classList.add('code-block-container'); // Custom class for container
                    pre.parentNode.insertBefore(container, pre);
                
                    container.appendChild(pre);

                    const copyButton = document.createElement('button');
                    copyButton.classList.add('copy-button'); // Custom class for button
                    copyButton.textContent = 'Copy';
                    container.appendChild(copyButton);

      
                              copyButton.addEventListener('click', () => {
                        const codeToCopy = codeBlock.textContent;
                        navigator.clipboard.writeText(codeToCopy).then(() => {
                            copyButton.textContent = 'Copied!';
                            setTimeout(() => {
                                copyButton.textContent = 'Copy';
    
                                        }, 2000);
                        }).catch(err => {
                            console.error('Failed to copy: ', err);
                 
                       });
                    });
                }
            });
       });
    </script>
</BaseLayout>